{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"EntityTableDataProvider","dependencies@STRING":["/libs/bndly/data/scripts/cy/TableDataProvider","/libs/bndly/data/scripts/cy/RestBeans"],"script@STRING":"var EntityTableDataProvider = TableDataProvider.extend({\r\n\tconstruct: function(config) {\r\n\t\tif(!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\t\tif(config.pageSize === undefined || config.pageSize === null) {\r\n\t\t\tconfig.pageSize = 10;\r\n\t\t}\r\n\t\tif(config.pageOffset === undefined || config.pageOffset === null) {\r\n\t\t\tconfig.pageOffset = 0;\r\n\t\t}\r\n\t\tif(config.proto) {\r\n\t\t\tvar _this = this;\r\n\t\t\tconfig.proto.addListener(\"foundSimilar\", function(proto, page) {\r\n\t\t\t\t_this.page = page;\r\n\t\t\t\t_this.fireEvent(\"load\", page.getItems());\r\n\t\t\t}, this) ;\r\n\t\t}\r\n\t\tthis.callSuper(arguments, config);\r\n\t},\r\n\tgetTotalPages: function() {\r\n\t\tvar count = 0;\r\n\t\tif(this.page) {\r\n\t\t\tvar paginationInfo = this.page.getPage();\r\n\t\t\tif(paginationInfo) {\r\n\t\t\t\tcount = paginationInfo.getTotalRecords();\r\n\t\t\t\tif(count) {\r\n\t\t\t\t\tvar ps = paginationInfo.getSize();\r\n\t\t\t\t\tcount = count % ps === 0 ? count / ps : Math.round(count / ps + 0.5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn count;\r\n\t},\r\n\tgetCurrentPage: function() {\r\n\t\treturn this.pageOffset / this.pageSize + 1;\r\n\t},\r\n\tgetPageSize: function() {\r\n\t\treturn this.pageSize;\r\n\t},\r\n\tgetPageOffset: function() {\r\n\t\treturn this.pageOffset;\r\n\t},\r\n\tgetPageItems: function() {\r\n\t\treturn this.items;\r\n\t},\r\n\tsetPageSize: function(size, shouldReload) {\r\n\t\tthis.pageSize = size;\r\n\t\tif(shouldReload) {\r\n\t\t\tthis.loadPage();\r\n\t\t}\r\n\t},\r\n\tsetPageOffset: function(offset, shouldReload) {\r\n\t\tthis.pageOffset = offset;\r\n\t\tif(shouldReload) {\r\n\t\t\tthis.loadPage();\r\n\t\t}\r\n\t},\r\n\tloadPage: function() {\r\n\t\tvar proto;\r\n\t\tif(this.proto) {\r\n\t\t\tproto = this.proto;\r\n\t\t} else if(this.entityType) {\r\n\t\t\tproto = new RestBeans[this.entityType]();\r\n\t\t\tvar _this = this;\r\n\t\t\tproto.addListener(\"foundSimilar\", function(proto, page){\r\n\t\t\t\t_this.page = page;\r\n\t\t\t\t_this.fireEvent(\"load\", page.getItems());\r\n\t\t\t}, this) ;\r\n\t\t}\r\n\t\tvar p = new RestBeans.PaginationRestBean();\r\n\t\tp.setSize(this.pageSize);\r\n\t\tp.setStart(this.pageOffset);\r\n\t\tproto.setPage(p);\r\n\t\t\t\t\tthis.applySorting(proto);\r\n\t\tproto.findAll();\r\n\t}\r\n});\r\nreturn EntityTableDataProvider;","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":""}}
