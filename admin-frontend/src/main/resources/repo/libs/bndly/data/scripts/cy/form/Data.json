{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"Data","dependencies@STRING":["/libs/bndly/data/scripts/cy/ui/input/Button","/libs/bndly/data/scripts/cy/ui/IFrame","/libs/bndly/data/scripts/cy/ui/Link"],"script@STRING":"return [\r\n\t{\r\n\t\titems: [{\r\n\t\t\t\tmember: \"name\",\r\n\t\t\t\tlabelText: \"Name\",\r\n\t\t\t\tmandatory: true\r\n\t\t\t}, {\r\n\t\t\t\tmember: \"contentType\",\r\n\t\t\t\tlabelText: \"Content type\",\r\n\t\t\t\tmandatory: true\r\n\t\t\t}, {\r\n\t\t\t\tmember: \"createdOn\",\r\n\t\t\t\tlabelText: \"Created on\"\r\n\t\t\t}, {\r\n\t\t\t\tmember: \"updatedOn\",\r\n\t\t\t\tlabelText: \"Updated on\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"upload\",\r\n\t\t\t\tlabelText: \"Upload\",\r\n\t\t\t\tconstructorFn: \"FileInput\",\r\n\t\t\t\tinputConfig: {\r\n\t\t\t\t\teager: false\r\n\t\t\t\t},\r\n\t\t\t\tinit: function(instance) {\r\n\t\t\t\t\tinstance.addListener(\"selected\", function() {\r\n\t\t\t\t\t\tvar fd = instance.getFileDescription();\r\n\t\t\t\t\t\tif (!instance.entity.getName()) {\r\n\t\t\t\t\t\t\tinstance.entity.setName(fd.name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!instance.entity.getContentType()) {\r\n\t\t\t\t\t\t\tinstance.entity.setContentType(fd.type);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tinstance.entity.addListener(\"persisted\", function() {\r\n\t\t\t\t\t\tinstance.entity.addSingleInvocationListener(\"reloaded\", function(data) {\r\n\t\t\t\t\t\t\tif (instance.isFileSelected()) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"should upload now\");\r\n\t\t\t\t\t\t\t\tvar ul = data.hasLink(\"upload\");\r\n\t\t\t\t\t\t\t\tif (ul) {\r\n\t\t\t\t\t\t\t\t\tinstance.uploadToUrl(ul.getHref());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log(\"nothing to upload\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t}\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"download\",\r\n\t\t\t\tlabelText: \"Download\",\r\n\t\t\t\tconstructorFn: Link,\r\n\t\t\t\tinit: function(link, entry) {\r\n\t\t\t\t\tvar applyDownloadLink = function(entity){\r\n\t\t\t\t\t\tvar dl = entity.hasLink(\"download\");\r\n\t\t\t\t\t\tif(dl) {\r\n\t\t\t\t\t\t\tlink.setUrl(dl.getHref());\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlink.setUrl();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tentry.addListener(\"changed\", function(entity, member, value, oldValue){\r\n\t\t\t\t\t\tapplyDownloadLink(entity);\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tapplyDownloadLink(entry);\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t}\r\n];","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":""}}
