{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"AccountView","script@STRING":"var AccountView = ViewComponent.extend({\r\n\tconstruct: function(config) {\r\n\t\tif (!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\t\tvar \r\n\t\t\tthat = this,\r\n\t\t\tlockButton = new Button({\r\n\t\t\t\tlabel: \"lock\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: that.lockButtonClicked,\r\n\t\t\t\t\t\tscope: that\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tunlockButton = new Button({\r\n\t\t\t\tlabel: \"unlock\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: that.unlockButtonClicked,\r\n\t\t\t\t\t\tscope: that\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\trequestActivationTokenButton = new Button({\r\n\t\t\t\tlabel: \"request activation\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: that.requestActivationTokenButtonClicked,\r\n\t\t\t\t\t\tscope: that\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateAccountButton = new Button({\r\n\t\t\t\tlabel: \"create account\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: that.createAccountButtonClicked,\r\n\t\t\t\t\t\tscope: that\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdeleteAccountButton = new Button({\r\n\t\t\t\tlabel: \"delete account\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: that.deleteAccountButtonClicked,\r\n\t\t\t\t\t\tscope: that\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tactivateButton = new Button({\r\n\t\t\t\tlabel: \"activate\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: function(){\r\n\t\t\t\t\t\tthat.activateAccount(config.activationTokenInput.getValue());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tchangePasswordButton = new Button({\r\n\t\t\t\tlabel: \"change password\",\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: function(){\r\n\t\t\t\t\t\tthat.changePassword();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tsearchTermInput = new SearchTermInput({\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tsearchTermSubmitted: function(accountName) {\r\n\t\t\t\t\t\tvar bean = new RestBeans[\"AccountLookupRestBean\"]();\r\n\t\t\t\t\t\tbean.setAccountName(accountName);\r\n\t\t\t\t\t\tRestBeans.root.follow({\r\n\t\t\t\t\t\t\trel: \"findAccount\",\r\n\t\t\t\t\t\t\tpayload: bean,\r\n\t\t\t\t\t\t\tcb: function(account) {\r\n\t\t\t\t\t\t\t\t// found\r\n\t\t\t\t\t\t\t\tthat.setAccount(account);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfcb: function() {\r\n\t\t\t\t\t\t\t\t// not found\r\n\t\t\t\t\t\t\t\tthat.setAccount(null);\r\n\t\t\t\t\t\t\t\tif(accountName) {\r\n\t\t\t\t\t\t\t\t\tthat.passwordInput.enable();\r\n\t\t\t\t\t\t\t\t\tthat.createAccountButton.enable();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t;\r\n\t\tconfig.lockButton = lockButton;\r\n\t\tconfig.unlockButton = unlockButton;\r\n\t\tconfig.requestActivationTokenButton = requestActivationTokenButton;\r\n\t\tconfig.createAccountButton = createAccountButton;\r\n\t\tconfig.deleteAccountButton = deleteAccountButton;\r\n\t\tconfig.activateButton = activateButton;\r\n\t\tconfig.changePasswordButton = changePasswordButton;\r\n\t\tconfig.searchTermInput = searchTermInput;\r\n\t\tconfig.titleText = new Text({value: \"Accounts\", tag: \"h1\"});\r\n\t\tconfig.activationTokenInput = new TextInput({\r\n\t\t\tlabel: \"Activation token\",\r\n\t\t\tdisabled: true, \r\n\t\t\tvalue: \"\", \r\n\t\t\tplaceholder: \"activation token goes here\"\r\n\t\t});\r\n\t\tconfig.passwordInput = new TextInput({\r\n\t\t\tlabel: \"Password\",\r\n\t\t\tdisabled: true, \r\n\t\t\tvalue: \"\", \r\n\t\t\ttype: \"password\",\r\n\t\t\tplaceholder: \"password for account goes here\"\r\n\t\t});\r\n\t\tconfig.container = new ViewContainer({\r\n\t\t\titems: [\r\n\t\t\t\tsearchTermInput,\r\n\t\t\t\tnew Form({\r\n\t\t\t\t\titems:[\r\n\t\t\t\t\t\tconfig.activationTokenInput,\r\n\t\t\t\t\t\tconfig.passwordInput,\r\n\t\t\t\t\t\tactivateButton\r\n\t\t\t\t\t]\r\n\t\t\t\t}),\r\n\t\t\t\tnew ButtonGroup({\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\tlockButton,\r\n\t\t\t\t\t\tunlockButton,\r\n\t\t\t\t\t\trequestActivationTokenButton,\r\n\t\t\t\t\t\tcreateAccountButton,\r\n\t\t\t\t\t\tchangePasswordButton,\r\n\t\t\t\t\t\tdeleteAccountButton\r\n\t\t\t\t\t]\r\n\t\t\t\t})\r\n\t\t\t]\r\n\t\t});\r\n\t\tthis.callSuper(arguments, config);\r\n\t},\r\n\tdestroy: function() {\r\n\t\tthis.invokeSuper(arguments);\r\n\t\tthis.titleText.destroy();\r\n\t\tthis.container.destroy();\r\n\t},\r\n\trenderTo: function(renderTarget) {\r\n\t\tthis.titleText.renderTo(renderTarget);\r\n\t\tthis.container.renderTo(renderTarget);\r\n\t\tthis.invokeSuper(arguments);\r\n\t},\r\n\tlockButtonClicked: function() {\r\n\t\tif(this.account) {\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"lock\", \r\n\t\t\t\tcb:function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tunlockButtonClicked: function() {\r\n\t\tif(this.account) {\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"unlock\", \r\n\t\t\t\tcb:function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\trequestActivationTokenButtonClicked: function() {\r\n\t\tif(this.account) {\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"requestActivationToken\", \r\n\t\t\t\tcb:function(token) {\r\n\t\t\t\t\t// render token\r\n\t\t\t\t\tthis.activationTokenInput.setValue(token.getToken());\r\n\t\t\t\t\tthis.activationTokenInput.enable();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(msg){\r\n\t\t\t\t\tthis.activationTokenInput.setValue(\"\");\r\n\t\t\t\t\tthis.activationTokenInput.disable();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tcreateAccountButtonClicked: function() {\r\n\t\tvar \r\n\t\t\taccountName = this.searchTermInput.getValue(),\r\n\t\t\tpassword = this.passwordInput.getValue(),\r\n\t\t\tbean\r\n\t\t;\r\n\t\tif(accountName) {\r\n\t\t\tbean = new RestBeans[\"AccountCreationRestBean\"]();\r\n\t\t\tbean.setAccountName(accountName);\r\n\t\t\tif(password) {\r\n\t\t\t\tbean.setPassword(password);\r\n\t\t\t}\r\n\t\t\tRestBeans.root.follow({\r\n\t\t\t\trel: \"createAccount\",\r\n\t\t\t\tpayload: bean,\r\n\t\t\t\tcb: function(accountUrl) {\r\n\t\t\t\t\t// found\r\n\t\t\t\t\tvar account = new RestBeans[\"AccountRestBean\"]();\r\n\t\t\t\t\taccount.setLink(\"self\", accountUrl, \"GET\");\r\n\t\t\t\t\tthis.account = account;\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function() {\r\n\t\t\t\t\t// not found\r\n\t\t\t\t\tthis.setAccount(null);\r\n\t\t\t\t\tif(accountName) {\r\n\t\t\t\t\t\tthis.createAccountButton.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tdeleteAccountButtonClicked: function(){\r\n\t\tif(this.account) {\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"remove\", \r\n\t\t\t\tcb:function(token) {\r\n\t\t\t\t\tthis.setAccount(null);\r\n\t\t\t\t\tthis.searchTermInput.setValue(null);\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(msg){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\treloadAccount: function() {\r\n\t\tif(this.account) {\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"self\", \r\n\t\t\t\tcb:function(account){\r\n\t\t\t\t\tthis.setAccount(account);\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(){\r\n\t\t\t\t\tthis.setAccount(null);\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tactivateAccount: function(token) {\r\n\t\tif(this.account) {\r\n\t\t\tvar bean = new RestBeans[\"AccountActivationTokenRestBean\"]();\r\n\t\t\tbean.setToken(token);\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"activate\",\r\n\t\t\t\tpayload: bean,\r\n\t\t\t\tcb:function(account){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tchangePassword: function() {\r\n\t\tvar pw = this.passwordInput.getValue();\r\n\t\tif(this.account && pw) {\r\n\t\t\tvar bean = new RestBeans[\"AccountPasswordRestBean\"]();\r\n\t\t\tbean.setPassword(pw);\r\n\t\t\tthis.account.follow({\r\n\t\t\t\trel:\"changePassword\",\r\n\t\t\t\tpayload: bean,\r\n\t\t\t\tcb:function(){\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tfcb: function() {\r\n\t\t\t\t\tthis.reloadAccount();\r\n\t\t\t\t},\r\n\t\t\t\tscope: this\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t},\r\n\tsetAccount: function(account) {\r\n\t\tthis.account = account;\r\n\t\tthis.activationTokenInput.setValue(\"\");\r\n\t\tthis.activationTokenInput.disable();\r\n\t\tif(account) {\r\n\t\t\tif(account.hasLink(\"lock\")) {\r\n\t\t\t\tthis.lockButton.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.lockButton.disable();\r\n\t\t\t}\r\n\t\t\tif(account.hasLink(\"unlock\")) {\r\n\t\t\t\tthis.unlockButton.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.unlockButton.disable();\r\n\t\t\t}\r\n\t\t\tif(account.hasLink(\"requestActivationToken\")) {\r\n\t\t\t\tthis.requestActivationTokenButton.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.requestActivationTokenButton.disable();\r\n\t\t\t}\r\n\t\t\tif(account.hasLink(\"activate\")) {\r\n\t\t\t\tthis.activateButton.enable();\r\n\t\t\t\tthis.activationTokenInput.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.activateButton.disable();\r\n\t\t\t\tthis.activationTokenInput.disable();\r\n\t\t\t}\r\n\t\t\tif(account.hasLink(\"changePassword\")) {\r\n\t\t\t\tthis.passwordInput.enable();\r\n\t\t\t\tthis.changePasswordButton.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.passwordInput.disable();\r\n\t\t\t\tthis.changePasswordButton.disable();\r\n\t\t\t}\r\n\t\t\tif(account.hasLink(\"remove\")) {\r\n\t\t\t\tthis.deleteAccountButton.enable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.deleteAccountButton.disable();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.lockButton.disable();\r\n\t\t\tthis.unlockButton.disable();\r\n\t\t\tthis.requestActivationTokenButton.disable();\r\n\t\t\tthis.activateButton.disable();\r\n\t\t\tthis.changePasswordButton.disable();\r\n\t\t\tthis.passwordInput.disable();\r\n\t\t\tthis.deleteAccountButton.disable();\r\n\t\t}\r\n\t\tthis.createAccountButton.disable();\r\n\t\tthis.passwordInput.setValue(\"\");\r\n\t}\r\n});\r\nreturn AccountView;","initMethod@STRING":"","proxy@STRING":"","export@STRING":"","moduleId@STRING":"","dependencies@STRING":["/libs/bndly/data/scripts/cy/ui/Text","/libs/bndly/data/scripts/cy/ui/ViewComponent","/libs/bndly/data/scripts/cy/ui/container/ViewContainer","/libs/bndly/data/scripts/cy/RestBeans","/libs/bndly/data/scripts/cy/ui/input/SearchTermInput","/libs/bndly/data/scripts/cy/ui/input/Button","/libs/bndly/data/scripts/cy/ui/container/ButtonGroup","/libs/bndly/data/scripts/cy/ui/input/TextInput","/libs/bndly/data/scripts/cy/ui/container/Form"]}}
