{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"DataStoreView","dependencies@STRING":["/libs/bndly/data/scripts/cy/TableDataProvider","/libs/bndly/data/scripts/cy/TableBinder","/libs/bndly/data/scripts/cy/ui/input/DropZone","/libs/bndly/data/scripts/cy/ui/container/Tab","/libs/bndly/data/scripts/cy/ui/container/TabView","/libs/bndly/data/scripts/cy/ui/Text","/libs/bndly/data/scripts/cy/ui/ViewComponent","/libs/bndly/data/scripts/cy/ui/container/ViewContainer","/libs/bndly/data/scripts/cy/RestBeans","/libs/vendor/jquery"],"script@STRING":"var DataStoreView = ViewComponent.extend({\r\n\tconstruct: function(config) {\r\n\t\tif (!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\t\tconfig.titleText = new Text({value: \"Data Stores\", tag: \"h1\"});\r\n\t\tconfig.container = new ViewContainer({\r\n\t\t\titems: [\r\n\t\t\t]\r\n\t\t});\r\n\t\tthis.callSuper(arguments, config);\r\n\t\tthis.tabView = new TabView();\r\n\t\tthis.container.items.add(this.tabView);\r\n\t\tRestBeans.root.follow({\r\n\t\t\trel: \"dataStores\",\r\n\t\t\tcb: this.dataStoresLoaded,\r\n\t\t\tscope: this\r\n\t\t});\r\n\t},\r\n\tdestroy: function() {\r\n\t\tthis.invokeSuper(arguments);\r\n\t\tthis.titleText.destroy();\r\n\t},\r\n\trenderTo: function(renderTarget) {\r\n\t\tthis.renderTitle(renderTarget);\r\n\t\tthis.container.renderTo(renderTarget);\r\n\t\tthis.invokeSuper(arguments);\r\n\t},\r\n\trenderTitle: function(renderTarget) {\r\n\t\tif (this.titleText) {\r\n\t\t\tthis.titleText.renderTo(renderTarget);\r\n\t\t}\r\n\t},\r\n\tdataStoresLoaded: function(dataStores) {\r\n\t\tthis.dataStores = dataStores;\r\n\t\tthis.dataStores.getItems().each(function(item, index){\r\n\t\t\tthis.tabView.items.add(new Tab({\r\n\t\t\t\tlabelText: item.getName(),\r\n\t\t\t\titems: [\r\n\t\t\t\t\tnew DropZone({\r\n\t\t\t\t\t\tuploadLocation: $(\"head\").data(\"base-url\")+\"/data/\"+item.getName()+\"/bin/\"\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tnew TableBinder({\r\n\t\t\t\t\t\tcolumns:[\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabelText: \"Name\",\r\n\t\t\t\t\t\t\t\tpath: \"name\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabelText: \"Content-Type\",\r\n\t\t\t\t\t\t\t\tpath: \"contentType\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabelText: \"Created\",\r\n\t\t\t\t\t\t\t\tpath: \"createdOn\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabelText: \"Updated\",\r\n\t\t\t\t\t\t\t\tpath: \"updatedOn\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tdataProvider: new TableDataProvider({\r\n\t\t\t\t\t\t\tpageOffset: 0,\r\n\t\t\t\t\t\t\tpageSize: 1,\r\n\t\t\t\t\t\t\tloadPage: function(){\r\n\t\t\t\t\t\t\t\tvar _this = this;\r\n\t\t\t\t\t\t\t\titem.follow({rel:\"items\", cb: function(dataStoreItems){\r\n\t\t\t\t\t\t\t\t\t_this.setPageSize(dataStoreItems.getItems().size());\r\n\t\t\t\t\t\t\t\t\t_this.fireEvent(\"load\", dataStoreItems.getItems());\r\n\t\t\t\t\t\t\t\t}});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t}));\r\n\t\t}, this);\r\n\t}\r\n});\r\nreturn DataStoreView;","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":"","export@STRING":""}}
