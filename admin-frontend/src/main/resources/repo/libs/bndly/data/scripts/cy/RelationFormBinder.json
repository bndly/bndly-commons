{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"RelationFormBinder","dependencies@STRING":["/libs/bndly/data/scripts/cy/views/SelfRelationView","/libs/bndly/data/scripts/cy/views/RelationView","/libs/bndly/data/scripts/cy/ui/container/TabView","/libs/bndly/data/scripts/cy/ui/container/Tab","/libs/bndly/data/scripts/cy/Collection","/libs/bndly/data/scripts/cy/ui/container/ViewContainer","/libs/bndly/data/scripts/cy/ui/ViewComponent"],"script@STRING":"var RelationFormBinder = ViewContainer.extend({\r\n\tconstruct: function(config) {\r\n\t\tif (!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\r\n\t\t// wrap the relations into an observable collection\r\n\t\tvar tabView = new TabView();\r\n\t\tconfig.relations = new Collection(config.relations);\r\n\t\tconfig.items = [\r\n\t\t\ttabView\r\n\t\t];\r\n\t\tconfig.keyedInputs = {};\r\n\r\n\t\tthis.callSuper(arguments, config);\r\n\t\t\r\n\t\tconfig.relations.each(function(relationDescriptor) {\r\n\t\t\tvar tabItem = this.buildTabItemFromRelation(relationDescriptor);\r\n\t\t\tif(tabItem) {\r\n\t\t\t\tvar activeByDefault = tabItem instanceof SelfRelationView,\r\n\t\t\t\ttab = new Tab({\r\n\t\t\t\t\tname: relationDescriptor.name,\r\n\t\t\t\t\tlabelText: relationDescriptor.labelText,\r\n\t\t\t\t\tactiveByDefault: activeByDefault,\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\ttabItem\r\n\t\t\t\t\t]\r\n\t\t\t\t});\r\n\t\t\t\ttabView.items.add(tab);\t\r\n\t\t\t}\r\n\t\t}, this);\r\n\t},\r\n\tdestroy: function() {\r\n\t\tthis.callSuper(arguments);\r\n\t},\r\n\tbuildTabItemFromRelation: function(relationDescriptor) {\r\n\t\tif(relationDescriptor.link) {\r\n\t\t\tif (relationDescriptor.link === \"self\") {\r\n\t\t\t\t// new SelfRelationView\r\n\t\t\t\treturn new SelfRelationView({\r\n\t\t\t\t\tentity: this.entity,\r\n\t\t\t\t\tkeyedInputs: this.keyedInputs\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// new RelationView\r\n\t\t\t\treturn new RelationView({\r\n\t\t\t\t\tentity: this.entity,\r\n\t\t\t\t\tkeyedInputs: this.keyedInputs\r\n\t\t\t\t});\r\n\t\t\t}\t\r\n\t\t} else if(relationDescriptor.viewType) {\r\n\t\t\t// custom view\r\n\t\t\tvar cfg = relationDescriptor.viewConfig;\r\n\t\t\tif(!cfg) {\r\n\t\t\t\tcfg = {};\r\n\t\t\t}\r\n\t\t\tcfg.parent = this.entity;\r\n\t\t\tcfg.keyedInputs = this.keyedInputs\r\n\t\t\tvar view = new relationDescriptor.viewType(cfg);\r\n\t\t\tif(view instanceof ViewComponent) {\r\n\t\t\t\treturn view;\r\n\t\t\t} else {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"no link relation oder viewType for relation\");\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n});\r\nreturn RelationFormBinder;","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":""}}
